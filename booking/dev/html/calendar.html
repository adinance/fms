<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Meeting Room Booking</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet" />
    <link href="https://cdn.datatables.net/buttons/3.0.0/css/buttons.bootstrap5.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.css" rel="stylesheet" />
    <link href="https://cdn.datatables.net/2.1.4/css/dataTables.bootstrap5.min.css" rel="stylesheet" />

    <style>
        @import 'https://cdn.jsdelivr.net/gh/lazywasabi/thai-web-fonts@7/fonts/LINESeedSansTH/LINESeedSansTH.css';
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&family=Quicksand:wght@300..700&display=swap');

        :root {
            --font-main: "Quicksand", "LINE Seed Sans TH", sans-serif;
            --bg-light: #fff;
            --text-light: #000;
            --bg-dark: #121212;
            --text-dark: #fff;
            --card-dark: #1f1f1f;
            --border-dark: #333;
        }

        html,
        body {
            height: 100%;
        }

        body {
            font-family: var(--font-main);
            transition: background-color 0.3s, color 0.3s;
            display: flex;
            flex-direction: column;

        }

        a {
            text-decoration: none !important;
        }

        #mainLayout {
            flex-grow: 1;
            overflow: visible;
        }

        #sidebarMenu {
            width: 280px;
            transition: width 0.3s ease, margin 0.3s ease;
            overflow-x: hidden;
            flex-shrink: 0;
            overflow-y: auto;
        }

        /* üö© START: Sidebar/Menu Alignment Fixes */

        #sidebarMenu .nav-link {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            padding-left: 0.5rem;
        }

        /* NEW: ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÇ‡∏´‡∏°‡∏î‡∏Ç‡∏¢‡∏≤‡∏¢ (‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô) */
        #sidebarMenu:not(.collapsed) .nav-link i {
            width: 22px;
            margin-right: 8px;
            text-align: center;
            font-size: 1rem;
            display: inline-block;
            /* ‡πÉ‡∏´‡πâ‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° */
        }

        .collapse {
            transition: height 0.4s ease-in-out !important;
        }

        .collapsing {
            transition: height 0.4s ease-in-out !important;
        }

        #sidebarMenu .collapsed-toggle {
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-light);
            padding-top: 5px;
            padding-bottom: 5px;
            margin-top: 5px;
            transition: background-color 0.2s, color 0.2s;
        }

        #sidebarMenu .collapsed-toggle:hover {
            background-color: #e9ecef;
        }

        #sidebarMenu .collapsed-toggle .toggle-icon {
            transition: transform 0.3s ease;
        }

        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏Ç‡∏≠‡∏á Icon ‡πÉ‡∏ô‡πÇ‡∏´‡∏°‡∏î‡∏Ç‡∏¢‡∏≤‡∏¢ (‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å/‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠) */
        #sidebarMenu .collapsed-toggle i:not(.toggle-icon) {
            margin-right: 8px;
            width: 20px;
            text-align: center;
        }

        #sidebarMenu .collapsed-toggle.collapsed .toggle-icon {
            transform: rotate(-90deg);
        }

        #sidebarMenu.collapsed {
            width: 60px !important;
        }

        /* 1. ‡∏à‡∏±‡∏î‡∏ß‡∏≤‡∏á‡∏≠‡∏á‡∏Ñ‡πå‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡πÉ‡∏ô‡πÇ‡∏´‡∏°‡∏î‡∏¢‡∏∏‡∏ö‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á (‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å/‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠) */
        #sidebarMenu.collapsed .collapsed-toggle {
            text-align: center;
            padding: 0.5rem 0.5rem !important;
        }

        /* 2. ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏î‡∏ß‡∏≤‡∏á‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏Å‡πÉ‡∏ô‡πÇ‡∏´‡∏°‡∏î collapsed */
        #sidebarMenu.collapsed .collapsed-toggle i {
            font-size: 1.2rem;
            margin-right: 0;
            width: 30px;
            display: inline-block;
        }

        /* 3. ‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏°‡∏ô‡∏π‡∏¢‡πà‡∏≠‡∏¢‡πÉ‡∏ô‡πÇ‡∏´‡∏°‡∏î collapsed ‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á */
        #sidebarMenu.collapsed .nav-link {
            padding: 0.5rem 0.5rem;
            text-align: center;
            /* üö© FIX: ‡∏à‡∏±‡∏î‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤ nav-link ‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á */
        }

        /* 4. ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏°‡∏ô‡∏π‡∏¢‡πà‡∏≠‡∏¢‡πÉ‡∏ô‡πÇ‡∏´‡∏°‡∏î collapsed ‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á */
        #sidebarMenu.collapsed .nav-link i {
            margin-right: 0;
            font-size: 1.1rem;
            width: 100%;
            /* üö© FIX: ‡πÉ‡∏´‡πâ‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡πÉ‡∏ä‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡πÄ‡∏ï‡πá‡∏°‡∏ó‡∏µ‡πà */
            display: block;
            /* üö© FIX: ‡πÉ‡∏´‡πâ‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÅ‡∏¢‡∏Å‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° (‡∏ã‡∏∂‡πà‡∏á‡∏ã‡πà‡∏≠‡∏ô‡∏≠‡∏¢‡∏π‡πà) */
            text-align: center;
            /* üö© FIX: ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á */
        }

        #sidebarMenu.collapsed .nav-link span,
        #sidebarMenu.collapsed .collapsed-toggle span,
        #sidebarMenu.collapsed .collapsed-toggle .toggle-icon,
        #sidebarMenu.collapsed .sidebar-label,
        #sidebarMenu.collapsed hr {
            display: none;
        }

        /* üö© END: Sidebar/Menu Alignment Fixes */

        #sidebarMenu.collapsed .border-top {
            padding: 0.5rem !important;
        }

        #sidebarMenu.collapsed .border-top .w-100 {
            width: auto !important;
        }

        /* CSS for Sidebar Toggle Icon based on state (moved from the general section) */
        #sidebarMenu.collapsed #sidebarToggle i {
            transform: rotate(0deg);
            /* When collapsed (default), the icon points right */
            transition: transform 0.3s ease;
        }

        #sidebarMenu:not(.collapsed) #sidebarToggle i {
            transform: rotate(180deg);
            /* When expanded, rotate 180 deg to point left */
            transition: transform 0.3s ease;
        }

        /* NEW/ADJUSTED: Style for the non-FAB Toggle Button inside the sidebar */
        #sidebarMenu #sidebarToggle {
            border-radius: 4px;
            /* ‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏Ç‡∏≠‡∏á Sidebar */
            font-size: 1.2rem;
            color: var(--text-light);
            /* ‡πÉ‡∏ä‡πâ‡∏™‡∏µ‡∏ï‡∏≤‡∏°‡∏ò‡∏µ‡∏° */
            transition: background-color 0.3s, color 0.3s;
        }

        #sidebarMenu #sidebarToggle:hover {
            background-color: #e9ecef;
            /* Light mode hover */
        }

        /* Dark Mode specific styles for the toggle button */
        body.dark-mode #sidebarMenu #sidebarToggle {
            color: var(--text-dark);
        }

        body.dark-mode #sidebarMenu #sidebarToggle:hover {
            background-color: #2a2a2a;
            /* Dark mode hover */
        }

        /* End of Sidebar Toggle Icon CSS */


        #mainContent {
            overflow-y: visible;
        }

        /* CSS ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Dropdown ‡∏ã‡πâ‡∏≠‡∏ô Dropdown (Sub-Dropdown) */
        .dropdown-menu .dropend .dropdown-toggle {
            padding-right: 1.5rem;
        }

        .dropdown-menu .dropend .dropdown-menu {
            position: absolute;
            left: 100%;
            top: 0;
            margin-left: 0.1rem;
            margin-right: 0.1rem;
        }

        /* #miniCalendar {
            max-width: 100%;
            margin: 20px auto;
        } */

        #miniCalendar {
            max-width: 100%;
            /* ‡∏•‡∏î Margin ‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡πÅ‡∏•‡∏∞‡∏•‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å 20px ‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏•‡∏∑‡∏≠ 0 */
            margin: 15px auto 0 auto;
        }

        #miniCalendar .fc-scroller {
            overflow: visible !important;
        }

        #miniCalendar .fc-daygrid-body {
            max-height: none !important;
        }

        #miniCalendar .fc-daygrid-body-unbalanced .fc-daygrid-day-events {
            min-height: 0 !important;
        }

        #miniCalendar .fc-daygrid-day-frame {
            padding: 3px !important;
        }


        #miniCalendar .fc-toolbar-title {
            font-weight: 600;
        }


        /* --- FAB Button styles (Restored to original positions/purposes) --- */
        .fab {
            position: fixed;
            right: 30px;
            color: #fff;
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            font-size: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            z-index: 1000;
        }


        /* FAB Add (NEW: ‡∏¢‡πâ‡∏≤‡∏¢‡πÑ‡∏õ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏•‡πà‡∏≤‡∏á‡∏™‡∏∏‡∏î 30px) */
        .fab-add-new {
            bottom: 30px;
            background-color: #0d6efd;
            font-size: 30px;
        }

        .fab-add-new:hover {
            background-color: #0b5ed7;
        }

        /* Toggle Table (‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÉ‡∏´‡∏°‡πà: 100px) - ‡πÄ‡∏î‡∏¥‡∏° 170px */
        #toggleTable {
            background-color: #6c757d;
            font-size: 20px;
            bottom: 100px;
            /* Moved from 170px to 100px since sidebar toggle is gone */
        }

        #toggleTable:hover {
            background-color: #5c636a;
        }

        #bookingTable thead th {
            text-align: center !important;
            vertical-align: middle;
            text-transform: uppercase !important;
        }


        /* Light Mode Styles (Standard) */
        body.light-mode {
            background-color: var(--bg-light);
            color: var(--text-light);
        }

        body.light-mode .fc-col-header,
        body.light-mode .fc-event,
        body.light-mode .fc-daygrid-day-number {
            color: #000 !important;
        }

        body.light-mode .nav-link {
            color: #000;
        }

        body.light-mode #sidebarMenu {
            background-color: #f8f9fa !important;
        }

        body.light-mode .navbar {
            background-color: #f8f9fa !important;
        }

        body.light-mode #sidebarMenu .collapsed-toggle {
            color: #000;
        }

        body.light-mode #sidebarMenu .border-top {
            border-color: #e9ecef !important;
        }


        body.light-mode .navbar-nav .nav-link.active {
            background-color: #e9ecef !important;
            color: #0d6efd !important;
            border-radius: 6px;
        }

        body.light-mode #sidebarMenu .nav-link.active {
            background-color: #0d6efd !important;
            color: #fff !important;
            border-radius: 6px;
        }

        body.light-mode .dropdown-menu .dropdown-item.active {
            background-color: #0d6efd !important;
            color: #fff !important;
        }

        body.light-mode .fc-day-today {
            background-color: #e9ecef !important;
            border-radius: 0;
        }

        body.light-mode .fc-col-header-cell {
            background-color: #f8f9fa !important;
            color: #000 !important;
        }

        /* --- Dark Mode Styles --- */
        body.dark-mode {
            background-color: var(--bg-dark);
            color: var(--text-dark);
        }

        body.dark-mode .navbar,
        body.dark-mode #sidebarMenu {
            background-color: var(--card-dark) !important;
            border-color: var(--border-dark) !important;
        }

        body.dark-mode .navbar-brand,
        body.dark-mode .nav-link {
            color: var(--text-dark) !important;
        }

        body.dark-mode #sidebarMenu .collapsed-toggle {
            color: var(--text-dark);
        }

        body.dark-mode #sidebarMenu .border-top {
            border-color: var(--border-dark) !important;
        }

        body.dark-mode #sidebarMenu .collapsed-toggle:hover {
            background-color: #2a2a2a;
        }

        body.dark-mode .navbar-nav .nav-link.active {
            background-color: #444 !important;
            color: #fff !important;
            border-radius: 6px;
        }

        body.dark-mode #sidebarMenu .nav-link.active {
            background-color: #2a2a2a !important;
            color: #fff !important;
            border-radius: 6px;
        }

        body.dark-mode .dropdown-menu {
            background-color: var(--card-dark) !important;
            border-color: var(--border-dark) !important;
        }

        body.dark-mode .dropdown-menu .dropdown-item {
            color: var(--text-dark) !important;
        }

        body.dark-mode .dropdown-menu .dropdown-item:hover,
        body.dark-mode .dropdown-menu .dropdown-item:focus,
        body.dark-mode .dropdown-menu .dropend>.dropdown-toggle:hover,
        body.dark-mode .dropdown-menu .dropdown-item.active,
        body.dark-mode .dropdown-menu .dropdown-item:active {
            background-color: var(--card-dark) !important;
            color: #fff !important;
            background-image: none !important;
        }

        body.dark-mode .dropdown-menu .dropdown-item.dropdown-toggle {
            color: var(--text-dark) !important;
        }

        body.dark-mode .dropdown-menu .dropdown-item.dropdown-toggle:hover,
        body.dark-mode .dropdown-menu .dropdown-item.dropdown-toggle.active {
            color: #fff !important;
        }

        body.dark-mode .card {
            background-color: var(--card-dark) !important;
            border-color: var(--border-dark) !important;
            color: var(--text-dark) !important;
        }

        /* --- Dark Mode Styles for Modals & Forms --- */
        body.dark-mode .modal-content {
            background-color: var(--card-dark) !important;
            color: var(--text-dark) !important;
        }

        body.dark-mode .modal-header,
        body.dark-mode .modal-footer {
            border-color: var(--border-dark) !important;
        }

        body.dark-mode .btn-close {
            filter: invert(1) grayscale(100%) brightness(200%);
        }

        /* ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Input, Select, Textarea ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô Modal ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô Dark Mode ‡∏î‡πâ‡∏ß‡∏¢ */
        body.dark-mode .form-control,
        body.dark-mode .form-select {
            background-color: #2a2a2a !important;
            color: var(--text-dark) !important;
            border-color: #555 !important;
        }

        body.dark-mode .form-control:focus,
        body.dark-mode .form-select:focus {
            background-color: #2a2a2a !important;
            color: var(--text-dark) !important;
            border-color: #0d6efd !important;
            box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25);
        }

        /* ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Flatpickr Input ‡πÉ‡∏ô Dark Mode (‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£) */
        body.dark-mode .flatpickr-input {
            background-color: #2a2a2a !important;
            color: var(--text-dark) !important;
            border-color: #555 !important;
        }

        /* Flatpickr Calendar Theme (‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å Modal) */
        .flatpickr-calendar.open.dark-mode {
            background: var(--bg-dark);
            border: 1px solid var(--border-dark);
        }

        .flatpickr-calendar.open.dark-mode .flatpickr-day,
        .flatpickr-calendar.open.dark-mode .flatpickr-months .flatpickr-month {
            color: var(--text-dark);
        }

        .flatpickr-calendar.open.dark-mode .flatpickr-day.selected,
        .flatpickr-calendar.open.dark-mode .flatpickr-day.selected:hover {
            background: #0d6efd;
            border-color: #0d6efd;
        }

        .flatpickr-calendar.open.dark-mode .flatpickr-day.today {
            border-color: #0d6efd;
        }

        body.dark-mode #calendar {
            background: var(--card-dark);
            border-color: var(--border-dark);
        }

        body.dark-mode .fc-multimonth-month,
        body.dark-mode .fc-multimonth-header-table thead th,
        body.dark-mode .fc-multimonth-daygrid-table,
        body.dark-mode .fc-multimonth-daygrid-table td,
        body.dark-mode .fc-multimonth-daygrid-table .fc-daygrid-day {
            background-color: var(--card-dark) !important;
            border-color: var(--border-dark) !important;
            color: var(--text-dark) !important;
        }

        body.dark-mode #calendar table,
        body.dark-mode #calendar th,
        body.dark-mode #calendar td,
        body.dark-mode .fc-view-harness table,
        body.dark-mode .fc-scrollgrid table,
        body.dark-mode .fc-daygrid-body table,
        body.dark-mode .fc-scrollgrid-section,
        body.dark-mode .fc-daygrid-body,
        body.dark-mode .fc-col-header {
            border-color: var(--border-dark) !important;
        }

        body.dark-mode #miniCalendar table,
        body.dark-mode #miniCalendar th,
        body.dark-mode #miniCalendar td,
        body.dark-mode #miniCalendar .fc-col-header,
        body.dark-mode #miniCalendar .fc-scrollgrid-table,
        body.dark-mode #miniCalendar .fc-daygrid-day {
            border-color: var(--border-dark) !important;
        }

        body.dark-mode #miniCalendar .fc-scrollgrid-table {
            border-right-width: 0px !important;
        }

        body.dark-mode #miniCalendar .fc-col-header-cell:last-child,
        body.dark-mode .fc-daygrid-day:last-child {
            border-right-width: 0px !important;
        }

        body.dark-mode .fc-col-header,
        body.dark-mode .fc-event,
        body.dark-mode .fc-daygrid-day-number {
            color: #fff !important;
        }

        body.dark-mode .fc-day-today {
            background-color: #2a2a2a !important;
            border-radius: 0;
        }

        body.dark-mode .fc-col-header-cell {
            background-color: var(--card-dark) !important;
            color: #fff !important;
        }

        /* --- Dark Mode for DataTables --- */
        body.dark-mode table.dataTable {
            background-color: #1e1e1e;
            color: #e5e5e5;
        }

        body.dark-mode table.dataTable,
        body.dark-mode table.dataTable thead th,
        body.dark-mode table.dataTable tbody td {
            border-color: var(--border-dark) !important;
        }

        body.dark-mode table.dataTable thead th {
            background-color: #2a2a2a !important;
            color: #f1f1f1 !important;
        }

        body.dark-mode table.dataTable tbody td {
            background-color: #1e1e1e !important;
            color: #e5e5e5 !important;
        }

        body.dark-mode table.dataTable.stripe tbody tr.odd,
        body.dark-mode table.dataTable.display tbody tr.odd {
            background-color: #242424 !important;
        }

        body.dark-mode table.dataTable.stripe tbody tr.even,
        body.dark-mode table.dataTable.display tbody tr.even {
            background-color: #1c1c1c !important;
        }

        body.dark-mode .dataTables_wrapper .dataTables_filter input,
        body.dark-mode .dataTables_wrapper .dataTables_length select {
            background: #2a2a2a;
            color: #fff;
            border: 1px solid #555;
        }

        body.dark-mode .dataTables_wrapper .dataTables_paginate .paginate_button {
            color: #ddd !important;
        }

        /* --- Dark Mode Pagination (DataTables) --- */
        body.dark-mode .dataTables_wrapper .dataTables_paginate .paginate_button.current {
            background: #444 !important;
            color: #fff !important;
        }

        /* Override inline styles from applyPaginationTheme for consistency in Dark Mode */
        body.dark-mode .dataTables_wrapper .dataTables_paginate .paginate_button.btn-dark {
            background-color: #2a2a2a !important;
            border-color: #555 !important;
            color: #ddd !important;
        }

        body.dark-mode .dataTables_wrapper .dataTables_paginate .paginate_button.btn-dark.current {
            background-color: #444 !important;
            /* Force active color */
            color: #fff !important;
        }

        body.dark-mode .dataTables_wrapper .dataTables_paginate .paginate_button.btn-dark.disabled {
            background-color: #1f1f1f !important;
            border-color: #333 !important;
            color: #555 !important;
        }

        body.dark-mode .dataTables_wrapper .dataTables_info {
            color: #ccc !important;
        }

        body.dark-mode .form-check-label {
            color: var(--text-dark);
        }

        /* --- Footer Styles --- */
        #mainFooter {
            flex-shrink: 0;
            background-color: #f8f9fa;
            transition: background-color 0.3s, border-color 0.3s;
        }

        body.dark-mode #mainFooter {
            background-color: var(--card-dark) !important;
            border-color: var(--border-dark) !important;
        }

        body.dark-mode #mainFooter .text-muted {
            color: #bbb !important;
        }

        /* --- Logo Styles --- */
        .dark-mode-logo {
            display: none !important;
        }

        .light-mode-logo {
            display: inline-block !important;
        }

        body.dark-mode .dark-mode-logo {
            display: inline-block !important;
        }

        body.dark-mode .light-mode-logo {
            display: none !important;
        }

        #calendar .fc-toolbar-chunk:last-child .btn-group {
            flex-wrap: wrap;
            justify-content: flex-end;

        }

        #calendar .fc-toolbar-title {
            text-transform: uppercase !important;
        }

        body.dark-mode .fc .fc-timegrid-all-day,
        body.dark-mode .fc .fc-scrollgrid-section-sticky {
            background-color: #1f1f1f;
        }

        body.dark-mode .fc .fc-timegrid-axis,
        body.dark-mode .fc .fc-timegrid-slot-label {
            background-color: #181818;
            color: #bbb;
        }

        /* ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á list view */
        body.dark-mode .fc-list {
            background-color: #1e1e1e;
            color: #e0e0e0;
        }

        /* ‡πÅ‡∏ñ‡∏ß‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà (December 16, 2025) */
        body.dark-mode .fc-list-day-cushion {
            background-color: #262626;
            color: #9ecbff;
            border-color: #333;
        }

        /* ‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏±‡∏ô (Tuesday) */
        body.dark-mode .fc-list-day-text,
        body.dark-mode .fc-list-day-side-text {
            color: #9ecbff;
            font-weight: 500;
        }

        /* ‡πÅ‡∏ñ‡∏ß event */
        body.dark-mode .fc-list-event {
            background-color: #1f1f1f;
            border-color: #333;
        }

        /* hover event */
        body.dark-mode .fc-list-event:hover,
        body.dark-mode .fc-list-event.fc-event-forced-url:hover {
            background-color: inherit !important;
        }

        body.dark-mode .fc-list-event:hover {
            cursor: pointer;
        }

        body.dark-mode .fc-theme-standard .fc-list-event:hover {
            background-color: inherit !important;
        }

        /* ‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ all-day */
        body.dark-mode .fc-list-event-time {
            color: #9e9e9e;
        }

        /* ‡∏ä‡∏∑‡πà‡∏≠ event */
        body.dark-mode .fc-list-event-title {
            color: #eaeaea;
        }

        /* ‡πÄ‡∏™‡πâ‡∏ô‡∏Ñ‡∏±‡πà‡∏ô */
        body.dark-mode .fc-list-event td {
            border-color: #333;
        }


        /* ‡πÄ‡∏≠‡∏≤‡∏Å‡∏£‡∏≠‡∏ö‡∏ô‡∏≠‡∏Å‡∏™‡∏∏‡∏î‡∏≠‡∏≠‡∏Å */
        body.dark-mode .fc-list {
            border: none;
            outline: none;
        }

        /* ‡πÄ‡∏≠‡∏≤‡∏Å‡∏£‡∏≠‡∏ö table ‡∏≠‡∏≠‡∏Å */
        body.dark-mode .fc-list-table,
        body.dark-mode .fc-list-table td,
        body.dark-mode .fc-list-table th {
            border: none;
        }

        /* ‡πÄ‡∏≠‡∏≤‡πÄ‡∏™‡πâ‡∏ô‡∏Ç‡∏≠‡∏ö scrollgrid ‡∏≠‡∏≠‡∏Å */
        body.dark-mode .fc-scrollgrid,
        body.dark-mode .fc-scrollgrid-section,
        body.dark-mode .fc-scrollgrid-section table {
            border: none;
        }

        /* ‡∏Å‡∏±‡∏ô‡πÄ‡∏™‡πâ‡∏ô‡∏Ç‡∏≤‡∏ß‡πÅ‡∏ù‡∏á */
        body.dark-mode .fc * {
            box-shadow: none;
        }


        /* ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏£‡∏ß‡∏°‡∏Ç‡∏≠‡∏á Annual */
        body.dark-mode .fc-multimonth {
            background-color: transparent;
            border: none;
        }

        /* ‡∏Å‡∏•‡πà‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÄ‡∏î‡∏∑‡∏≠‡∏ô */
        body.dark-mode .fc-multimonth-month {
            background-color: #1f1f1f;
            border: none;
            box-shadow: none;
            border-radius: 8px;
        }

        /* ‡∏´‡∏±‡∏ß‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (January, February...) */
        body.dark-mode .fc-multimonth-title {
            color: #9ecbff;
            font-weight: 500;
        }

        /* ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏ô */
        body.dark-mode .fc-daygrid {
            background-color: transparent;
        }

        /* ‡∏ä‡πà‡∏≠‡∏á‡∏ß‡∏±‡∏ô */
        body.dark-mode .fc-daygrid-day-frame {
            background-color: #1f1f1f;
        }

        /* ‡πÄ‡∏™‡πâ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á (‡πÄ‡∏≠‡∏≤‡∏Ç‡∏≤‡∏ß‡∏≠‡∏≠‡∏Å) */
        body.dark-mode .fc-scrollgrid,
        body.dark-mode .fc-scrollgrid td,
        body.dark-mode .fc-scrollgrid th {
            border-color: #2f2f2f;
        }

        /* ‡πÄ‡∏≠‡∏≤‡∏Å‡∏£‡∏≠‡∏ö‡∏ô‡∏≠‡∏Å‡∏™‡∏∏‡∏î‡∏≠‡∏≠‡∏Å */
        body.dark-mode .fc-scrollgrid {
            border: none;
        }

        /* ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏ß‡∏±‡∏ô */
        body.dark-mode .fc-daygrid-day-number {
            color: #cfcfcf;
        }

        /* ‡∏ß‡∏±‡∏ô‡∏ô‡∏≠‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô */
        body.dark-mode .fc-day-other .fc-daygrid-day-number {
            color: #666;
        }


        /* ‡∏õ‡∏¥‡∏î hover ‡∏ó‡∏±‡πâ‡∏á tr ‡πÅ‡∏•‡∏∞ a ‡πÉ‡∏ô List mode */
        body.dark-mode .fc-list-table tr.fc-list-event:hover,
        body.dark-mode .fc-list-table tr.fc-list-event:hover td,
        body.dark-mode .fc-list-table tr.fc-list-event:hover a {
            background-color: transparent !important;
        }

        /* ‡∏Å‡∏£‡∏ì‡∏µ FullCalendar ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏™‡∏µ */
        body.dark-mode .fc-theme-standard .fc-list-event:hover {
            background-color: transparent !important;
        }

        /* ‡∏õ‡∏¥‡∏î hover ‡∏à‡∏≤‡∏Å Bootstrap link */
        body.dark-mode .fc-list-event a:hover {
            background-color: transparent !important;
        }


        /* ===== Annual / Year View ===== */

        body.dark-mode .fc-multimonth {
            background-color: transparent;
            border: none;
        }

        body.dark-mode .fc-multimonth-title {
            background-color: #1f1f1f;
            color: #e0e0e0;
            padding: 12px 0;
            border: none;
        }

        /* ‡∏Å‡∏±‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏Ç‡∏≤‡∏ß‡∏ó‡∏µ‡πà‡∏ã‡πà‡∏≠‡∏ô‡∏≠‡∏¢‡∏π‡πà */
        body.dark-mode .fc-multimonth-header {
            background-color: #1f1f1f;
            border: none;
        }

        /* ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏î‡∏∑‡∏≠‡∏ô */
        body.dark-mode .fc-multimonth-month {
            background-color: #1e1e1e;
            border: none;
            box-shadow: none;
        }

        /* ‡∏´‡∏±‡∏ß‡∏ß‡∏±‡∏ô (Sun Mon Tue...) */
        body.dark-mode .fc-col-header-cell {
            background-color: #1e1e1e;
            color: #4dabf7;
            border-color: #2f2f2f;
        }

        /* ‡∏ä‡πà‡∏≠‡∏á‡∏ß‡∏±‡∏ô */
        body.dark-mode .fc-daygrid-day-frame {
            background-color: #1e1e1e;
        }

        /* ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏ß‡∏±‡∏ô */
        body.dark-mode .fc-daygrid-day-number {
            color: #e0e0e0;
        }

        /* ‡∏ß‡∏±‡∏ô‡∏ô‡∏≠‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô */
        body.dark-mode .fc-day-other .fc-daygrid-day-number {
            color: #666;
        }

        /* ‡πÄ‡∏™‡πâ‡∏ô‡∏Å‡∏£‡∏¥‡∏î */
        body.dark-mode .fc-scrollgrid,
        body.dark-mode .fc-scrollgrid td,
        body.dark-mode .fc-scrollgrid th {
            border-color: #2f2f2f;
        }

        /* ‡πÄ‡∏≠‡∏≤‡∏Å‡∏£‡∏≠‡∏ö‡∏ô‡∏≠‡∏Å‡∏™‡∏∏‡∏î‡∏≠‡∏≠‡∏Å */
        body.dark-mode .fc-scrollgrid {
            border: none;
        }

        body.dark-mode .fc-multimonth .fc-col-header-cell-cushion {
            color: #e6e6e6;
        }

        /* Month / Week / Day */
        body.dark-mode .fc-col-header-cell-cushion {
            color: #e6e6e6;
            font-weight: 500;
        }


        /* ‡∏Å‡∏±‡∏ô‡∏Å‡∏£‡∏ì‡∏µ‡∏ñ‡∏π‡∏Å override */
        body.dark-mode .fc-theme-standard th {
            color: #e6e6e6;
        }


        .spacer-row {
            margin-top: 16px;
        }

        /* --- Flatpickr Dark Mode Customization (Month/Year Dropdown) --- */
body.dark-mode .flatpickr-calendar.dark-mode {
    background: #1f1f1f !important;
    border-color: #333 !important;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
}

/* ‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏Ç‡∏≠‡∏á Dropdown ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô */
body.dark-mode .flatpickr-calendar.dark-mode .flatpickr-month {
    background: #1f1f1f !important;
    color: #fff !important;
    fill: #fff !important;
}

/* ‡∏õ‡∏£‡∏±‡∏ö‡∏™‡∏µ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (Dropdown) */
body.dark-mode .flatpickr-calendar.dark-mode .flatpickr-monthDropdown-months {
    background: #2a2a2a !important;
    color: #fff !important;
}

/* ‡∏õ‡∏£‡∏±‡∏ö‡∏™‡∏µ‡∏ä‡πà‡∏≠‡∏á‡πÉ‡∏™‡πà‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏õ‡∏µ */
body.dark-mode .flatpickr-calendar.dark-mode .numInputWrapper span:hover {
    background: #333 !important;
}

body.dark-mode .flatpickr-calendar.dark-mode input.cur-year {
    color: #fff !important;
}

/* ‡∏™‡∏µ‡∏Ç‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡πÉ‡∏ô‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå (Mon, Tue...) */
body.dark-mode .flatpickr-calendar.dark-mode span.flatpickr-weekday {
    background: #1f1f1f !important;
    color: #9ecbff !important;
}

/* ‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏ß‡∏•‡∏≤ (Time Picker) ‡πÉ‡∏ô Dark Mode */
body.dark-mode .flatpickr-calendar.dark-mode .flatpickr-time {
    border-top: 1px solid #333 !important;
    background: #1f1f1f !important;
}

body.dark-mode .flatpickr-calendar.dark-mode .flatpickr-time input {
    color: #fff !important;
}

body.dark-mode .flatpickr-calendar.dark-mode .flatpickr-time .flatpickr-am-pm {
    color: #fff !important;
}

/* ‡∏õ‡∏£‡∏±‡∏ö‡∏™‡∏µ‡∏ï‡∏≠‡∏ô Hover ‡πÄ‡∏´‡∏ô‡∏∑‡∏≠‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô */
body.dark-mode .flatpickr-calendar.dark-mode .flatpickr-prev-month:hover,
body.dark-mode .flatpickr-calendar.dark-mode .flatpickr-next-month:hover {
    background: #333 !important;
}

/* --- Flatpickr Time Picker Dark Mode --- */

/* ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤ */
body.dark-mode .flatpickr-time {
    background-color: #1f1f1f !important;
    border-top: 1px solid #333 !important;
}

/* ‡∏ä‡πà‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á ‡πÅ‡∏•‡∏∞ ‡∏ô‡∏≤‡∏ó‡∏µ */
body.dark-mode .flatpickr-time input.flatpickr-hour,
body.dark-mode .flatpickr-time input.flatpickr-minute {
    background-color: #2a2a2a !important;
    color: #fff !important;
    border: 1px solid #444 !important;
    border-radius: 4px;
}

/* ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢ : ‡∏Ñ‡∏±‡πà‡∏ô‡∏Å‡∏•‡∏≤‡∏á */
body.dark-mode .flatpickr-time .flatpickr-time-separator {
    color: #fff !important;
}

/* ‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏π‡∏Å‡∏®‡∏£ ‡∏Ç‡∏∂‡πâ‡∏ô-‡∏•‡∏á (Arrow buttons) */
body.dark-mode .flatpickr-time .numInputWrapper span {
    border-left: 1px solid #444 !important;
}

body.dark-mode .flatpickr-time .numInputWrapper span:hover {
    background-color: #444 !important;
}

/* ‡∏™‡∏µ‡∏•‡∏π‡∏Å‡∏®‡∏£ (SVG) */
body.dark-mode .flatpickr-time .numInputWrapper span.arrowUp:after {
    border-bottom-color: #fff !important;
}

body.dark-mode .flatpickr-time .numInputWrapper span.arrowDown:after {
    border-top-color: #fff !important;
}

/* ‡πÄ‡∏°‡∏∑‡πà‡∏≠ Focus ‡∏ó‡∏µ‡πà‡∏ä‡πà‡∏≠‡∏á‡πÄ‡∏ß‡∏•‡∏≤ */
body.dark-mode .flatpickr-time input:focus {
    background-color: #333 !important;
    border-color: #0d6efd !important;
}

    </style>
</head>

<body class="p-0 light-mode">

    <!-- <nav class="navbar navbar-expand-lg navbar-light bg-light shadow-sm py-0 border-bottom"> -->
    <nav class="navbar sticky-top navbar-expand-lg navbar-light bg-light shadow-sm py-0 border-bottom">
        <div class="container-fluid">

            <a class="navbar-brand py-2 me-4 d-flex align-items-center" href="#">
                <img src="images/logo-black.png" alt="CMO Logo" class="me-1 rounded d-none d-md-block dark-mode-logo"
                    width="48px">
                <img src="images/logo-white.png" alt="CMO Logo" class="me-1 rounded light-mode-logo d-none d-md-block"
                    width="48px">
            </a>

            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                    </li>
                </ul>

                <ul class="navbar-nav">

                    <li class="nav-item dropdown ms-2">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button"
                            data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="bi bi-person-circle"></i> <span class="d-lg-none d-xl-inline"> User A</span>
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdown">
                            <li>
                                <a class="dropdown-item" href="#" id="nav-profile-theme">
                                    <i class="bi bi-moon me-2" id="profileThemeIcon"></i>
                                    <span>Switch to Dark Mode</span>
                                </a>
                            </li>
                            <li><a class="dropdown-item" href="#">Logout</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div id="mainLayout" class="d-flex flex-fill">

        <div id="sidebarMenu" class="d-flex flex-column flex-shrink-0 bg-light border-end p-2 collapsed">

            <a class="h6 mt-2 mb-1 pb-1 collapsed-toggle" data-bs-toggle="collapse" href="#carMenu" role="button"
                aria-expanded="true" aria-controls="carMenu">
                <i class="bi bi-car-front me-1 "></i>
                <span>Car Center</span>
            </a>

            <ul id="carMenu" class="nav nav-pills flex-column collapse show">
                <li class="nav-item"><a id="menu-car-center" href="#" class="nav-link"><i class="bi bi-ev-front"></i>
                        <span>All Booking</span></a></li>
                <li class="nav-item"><a id="menu-car-reserve" href="#" class="nav-link"><i
                            class="bi bi-ev-front-fill"></i>
                        <span>My Booking</span></a></li>
            </ul>

            <a class="h6 mt-1 mb-1 pb-1 collapsed-toggle" data-bs-toggle="collapse" href="#meetingMenu" role="button"
                aria-expanded="true" aria-controls="meetingMenu">
                <i class="bi bi-easel me-1 "></i>
                <span>Meeting Room</span>
            </a>

            <ul id="meetingMenu" class="nav nav-pills flex-column mb-auto collapse show">
                <li class="nav-item"><a id="menu-meeting-room" href="#" class="nav-link">
                        <i class="bi bi-calendar-week"></i><span>Booking Calendar</span></a></li>
                <!-- <li class="nav-item">
                    <a id="menu-meeting-calendar" href="#" class="nav-link active" aria-current="page">
                        <i class="bi bi-calendar-check-fill"></i><span>My Booking</span></a>
                </li> -->
                <li class="nav-item">
                    <a id="menu-meeting-calendar" href="#" class="nav-link active" aria-current="page">
                        <i class="bi bi-calendar-check-fill"></i><span>Booking Table</span></a>
                </li>
            </ul>

            <div class="mt-auto border-top p-2 text-center">
                <button id="sidebarToggle" class="btn btn-sm w-100 p-0 shadow-none">
                    <i class="bi bi-arrow-right-circle-fill"></i>
                </button>
            </div>

        </div>

        <div id="mainContent" class="flex-grow-1 p-3">
            <div class="container" id="contentContainer">
                <div class="row">
                    <div class="col-md-8">
                        <div class="card shadow-lg mt-4">
                            <div class="card-header">Main Calendar</div>
                            <div class="card-body pt-4 pb-5 ">
                                <div id="calendar"></div>
                            </div>
                            <div class="card-footer">* ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ ‡∏Å‡∏î‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà Hiligh ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á ‡∏´‡∏£‡∏∑‡∏≠
                                ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°
                                + ‡∏Ç‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</div>
                        </div>
                    </div>

                    <div class="col-md-4">
                        <div class="card shadow mt-4">
                            <div class="card-header text-end">Mini Calendar</div>
                            <div class="card-body pt-0 ">
                                <div id="miniCalendar"></div>
                            </div>
                        </div>

                        <div class="card shadow mt-3">
                            <div class="card-body py-3">
                                <div class="row gx-0">
                                    <div class="col-sm-4">
                                        <div class="form-check mb-2">
                                            <input type="checkbox" class="form-check-input room-filter"
                                                id="filter_room_1" value="Meeting 1" checked>
                                            <label class="form-check-label" for="filter_room_1"
                                                style="white-space: nowrap;"> Meeting 1</label>
                                        </div>
                                        <div class="form-check mb-2">
                                            <input type="checkbox" class="form-check-input room-filter"
                                                id="filter_room_2" value="Meeting 2" checked>
                                            <label class="form-check-label" for="filter_room_2"
                                                style="white-space: nowrap;"> Meeting 2</label>
                                        </div>
                                        <div class="form-check mb-2">
                                            <input type="checkbox" class="form-check-input room-filter"
                                                id="filter_room_3" value="Meeting 3" checked>
                                            <label class="form-check-label" for="filter_room_3"
                                                style="white-space: nowrap;"> Meeting 3</label>
                                        </div>
                                    </div>
                                    <div class="col-sm-8">
                                        <div class="form-check mb-2">
                                            <input type="checkbox" class="form-check-input room-filter"
                                                id="filter_room_4" value="Training Room 1 (Floor 3)" checked>
                                            <label class="form-check-label" for="filter_room_4"
                                                style="white-space: nowrap;"> Training Room 1 (Floor 3)</label>
                                        </div>
                                        <div class="form-check mb-2">
                                            <input type="checkbox" class="form-check-input room-filter"
                                                id="filter_room_5" value="Training Room 3 (Floor 1)" checked>
                                            <label class="form-check-label" for="filter_room_5"
                                                style="white-space: nowrap;"> Training Room 3 (Floor 1)</label>
                                        </div>
                                        <div class="form-check mb-2">
                                            <input type="checkbox" class="form-check-input room-filter"
                                                id="filter_room_6" value="‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏π‡∏ô (Floor 3)" checked>
                                            <label class="form-check-label" for="filter_room_6"
                                                style="white-space: nowrap;"> ‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏π‡∏ô (Floor 3)</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="card-footer text-end">Select room to display</div>
                        </div>
                        
                    </div>

                </div>

                <div class="row">
                    <div class="col-md-12">

                        <div class="card p-3 mt-5 shadow" id="tableWrapper">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <h5>üìã Booking List</h5>
                            </div>

                            <div class="d-flex align-items-center">
                                <label class="me-2 fw-bold small text-uppercase" for="unitFilter">Group By  </label>
                                <select id="unitFilter" class="form-select form-select-sm" style="width: 220px;">
                                    <option value="">All Units (‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î)</option>
                                    <option value="Information Technology">Information Technology</option>
                                    <option value="Human Resources">Human Resources</option>
                                    <option value="Marketing">Marketing</option>
                                    <option value="Operations">Operations</option>
                                    <option value="Finance">Finance</option>
                                </select>
                            </div>
                            <br>

                            <div>
                                <table id="bookingTable" class="table table-bordered table-striped">
                                    <thead>
                                        <tr>
                                            <th>Room</th>
                                            <th>Title</th>
                                            <th>Start</th>
                                            <th>End</th>
                                            <th>Booking Name</th>
                                            <th>Opearting Unit</th>
                                        </tr>
                                    </thead>
                                </table>
                            </div>
                        </div>

                    </div>

                </div>
            </div>

            <!-- <button id="toggleTable" class="fab"><i class="bi bi-table"></i></button> -->

            <button class="fab fab-add-new" data-bs-toggle="modal" data-bs-target="#bookingModal">
                <i class="bi bi-plus"></i>
            </button>

        </div>
    </div>

    <div class="modal fade" id="bookingModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <form id="bookingForm" class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Booking Form</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>

                <div class="modal-body">
                    <div class="mb-2">
                        <label>Title</label>
                        <input type="text" name="title" class="form-control" required />
                    </div>
                    <div class="mb-2">
                        <label>Room</label>
                        <select name="room" class="form-select" required>
                            <option value="Meeting 1">Meeting 1</option>
                            <option value="Meeting 2">Meeting 2</option>
                            <option value="Meeting 3">Meeting 3</option>
                            <option value="Training Room 1 (Floor 3)">Training Room 1 (Floor 3)</option>
                            <option value="Training Room 3 (Floor 1)">Training Room 3 (Floor 1)</option>
                            <option value="‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏π‡∏ô (Floor 3)">Poon Room (Floor 3)</option>
                        </select>
                    </div>
                    <div class="mb-2">
                        <label>Subject</label>
                        <input type="text" name="subject" class="form-control" required />
                    </div>
                    <div class="row">
                        <div class="col">
                            <label>Start Date</label>
                            <input type="text" id="start_time" name="start" class="form-control" required />
                        </div>
                        <div class="col">
                            <label>End Date</label>
                            <input type="text" id="end_time" name="end" class="form-control" required />
                        </div>
                    </div>
                    <div class="mt-2">
                        <label>Booked By</label>
                        <input type="text" name="booked_by" class="form-control" required />
                    </div>
                    <div class="mt-2">
                        <label>Note</label>
                        <textarea name="note" class="form-control" rows="2"></textarea>
                    </div>
                </div>
                <!-- <div class="modal-body">
                    <div class="mb-2">
                        <label>‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° (Title)</label>
                        <input type="text" name="title" class="form-control" required />
                    </div>
                    <div class="mb-2">
                        <label>‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° (Room)</label>
                        <select name="room" class="form-select" required>
                            <option value="Meeting 1">Meeting 1</option>
                            <option value="Meeting 2">Meeting 2</option>
                            <option value="Meeting 3">Meeting 3</option>
                            <option value="Training Room 1 (Floor 3)">Training Room 1 (Floor 3)</option>
                            <option value="Training Room 3 (Floor 1)">Training Room 3 (Floor 1)</option>
                            <option value="‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏π‡∏ô (Floor 3)">‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏π‡∏ô (Floor 3)</option>
                        </select>
                    </div>
                    <div class="mb-2">
                        <label>‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠/‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î (Subject)</label>
                        <input type="text" name="subject" class="form-control" required />
                    </div>
                    <div class="mb-2">
                        <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà (Date)</label>
                        <input type="text" id="meeting_date" name="meeting_date" class="form-control" required />
                    </div>
                    <div class="row">
                        <div class="col">
                            <label>‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏° (Start)</label>
                            <input type="text" id="start_time" name="start_time" class="form-control" required />
                        </div>
                        <div class="col">
                            <label>‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î (End)</label>
                            <input type="text" id="end_time" name="end_time" class="form-control" required />
                        </div>
                    </div>
                    <div class="mt-2">
                        <label>‡∏ú‡∏π‡πâ‡∏à‡∏≠‡∏á (Booked By)</label>
                        <input type="text" name="booked_by" class="form-control" required />
                    </div>
                    <div class="mt-2">
                        <label>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ (Note)</label>
                        <textarea name="note" class="form-control" rows="2"></textarea>
                    </div>
                </div> -->
                <div class="modal-footer">
                    <button class="btn btn-secondary" data-bs-dismiss="modal">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                    <button type="submit" class="btn btn-success">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
                </div>
            </form>
        </div>
    </div>

    <footer id="mainFooter" class="border-top py-2 px-3 text-center">
        <div class="container-fluid">
            <span class="text-muted">
                &copy; <span id="currentYear"></span> CMO PUBLIC COMPANY LIMITED. All rights reserved.
                <span class="d-none d-md-inline">| Last access: <span id="currentTime"></span></span>
            </span>
        </div>
    </footer>

    <div class="modal fade" id="detailModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Booking Detail</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-2"><b>‡∏´‡πâ‡∏≠‡∏á:</b> <span id="d_room"></span></div>
                    <div class="mb-2"><b>‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°:</b> <span id="d_title"></span></div>
                    <div class="mb-2"><b>‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠:</b> <span id="d_subject"></span></div>
                    <div class="mb-2"><b>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</b> <span id="d_date"></span></div>
                    <div class="mb-2"><b>‡πÄ‡∏ß‡∏•‡∏≤:</b> <span id="d_time_range"></span></div>
                    <div class="mb-2"><b>‡∏ú‡∏π‡πâ‡∏à‡∏≠‡∏á:</b> <span id="d_booked"></span></div>
                    <div class="mb-2"><b>‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏à‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö:</b> <span id="d_booked_time"></span></div>
                    <div class="mb-2"><b>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</b> <span id="d_note"></span></div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">‡∏õ‡∏¥‡∏î</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>
    <script src="https://cdn.datatables.net/2.1.4/js/dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/2.1.4/js/dataTables.bootstrap5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/3.0.0/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/3.0.0/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/3.0.0/js/buttons.print.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/3.0.0/js/buttons.excelHtml5.min.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const roomColors = {
                "Meeting 1": "#0d6efd",
                "Meeting 2": "#198754",
                "Meeting 3": "#fd7e14",
                "Training Room 1 (Floor 3)": "#6f42c1",
                "Training Room 3 (Floor 1)": "#dc3545",
                "‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏π‡∏ô (Floor 3)": "#20c997"
            };
            let darkMode = localStorage.getItem("darkMode") === "true";
            let isTableVisible = localStorage.getItem("isTableVisible") !== "false";
            let isSidebarCollapsed = localStorage.getItem("isSidebarCollapsed") === "true";
            const ACTIVE_MENU_KEY = 'activeMenuId';
            const NAVBAR_ACTIVE_KEY = 'navbarActiveId';
            const CAR_MENU_STATE = 'carMenuState';
            const MEETING_MENU_STATE = 'meetingMenuState';
            const UNIT_FILTER_KEY = 'selectedOperatingUnit';
            let calendar, miniCal, table;
            const DATA_URL = "data.json";
            // üö© Initializations
            initTheme();
            initSidebar();
            loadCollapseMenuState();
            loadUnitFilterState();
            initActiveMenu();
            initNavbarActiveMenu();
            initPickers();
            initCalendars();
            initTable();
            initEventHandlers();
            const getStartDay = (datetime) => datetime ? datetime.substring(0, 10) : "";

            function initNavbarActiveMenu() {
                const defaultNavbarId = 'nav-report-current-year';
                let activeNavbarId = localStorage.getItem(NAVBAR_ACTIVE_KEY) || defaultNavbarId;
                $('.navbar-nav .nav-link, .navbar-nav .dropdown-item').removeClass('active');
                if (activeNavbarId) {
                    const activeLink = $(`#${activeNavbarId}`);
                    if (activeLink.length) {
                        activeLink.addClass('active');
                        const parentDropdownToggle = activeLink.closest('.dropdown').find('.dropdown-toggle')
                            .first();
                        if (parentDropdownToggle.length) {
                            parentDropdownToggle.addClass('active');
                        }
                        const dropendToggle = activeLink.closest('.dropend').find(
                            '.dropdown-item.dropdown-toggle');
                        if (dropendToggle.length) {
                            dropendToggle.addClass('active');
                        }
                    }
                }
            }

            function initActiveMenu() {
                const defaultMenuId = "menu-meeting-calendar";
                let activeMenuId = localStorage.getItem(ACTIVE_MENU_KEY) || defaultMenuId;
                $("#sidebarMenu .nav-link").removeClass("active").removeAttr("aria-current");
                const activeLink = $(`#${activeMenuId}`);
                if (activeLink.length) {
                    activeLink.addClass("active").attr("aria-current", "page");
                } else {
                    $(`#${defaultMenuId}`).addClass("active").attr("aria-current", "page");
                    localStorage.setItem(ACTIVE_MENU_KEY, defaultMenuId);
                }
            }

            function initSidebar() {
                applySidebarState(isSidebarCollapsed);
                // **‡∏•‡∏ö** ‡πÇ‡∏Ñ‡πâ‡∏î jQuery ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏´‡πà‡∏≠‡∏´‡∏∏‡πâ‡∏°‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡πâ‡∏ß‡∏¢ <span> ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å HTML ‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏≥‡πÑ‡∏ß‡πâ‡πÅ‡∏•‡πâ‡∏ß
                // $("#sidebarMenu .nav-link").each(function() { ... });
            }

            function applySidebarState(isCollapsed) {
                const sidebar = document.getElementById("sidebarMenu");
                const toggleIcon = document.querySelector("#sidebarToggle i");
                const contentContainer = document.getElementById("contentContainer");
                if (isCollapsed) {
                    sidebar.classList.add("collapsed");
                    // ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏¢‡∏∏‡∏ö: ‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏Ñ‡∏ß‡∏£‡∏ä‡∏µ‡πâ‡πÑ‡∏õ‡∏ó‡∏≤‡∏á‡∏Ç‡∏ß‡∏≤ (bi-arrow-right-circle-fill) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î
                    toggleIcon.classList.remove("bi-arrow-left-circle-fill");
                    toggleIcon.classList.add("bi-arrow-right-circle-fill");
                    contentContainer.classList.remove("container");
                    contentContainer.classList.add("container-fluid");
                } else {
                    sidebar.classList.remove("collapsed");
                    // ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ç‡∏¢‡∏≤‡∏¢: ‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏Ñ‡∏ß‡∏£‡∏ä‡∏µ‡πâ‡πÑ‡∏õ‡∏ó‡∏≤‡∏á‡∏ã‡πâ‡∏≤‡∏¢ (bi-arrow-left-circle-fill) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏¥‡∏î
                    toggleIcon.classList.remove("bi-arrow-right-circle-fill");
                    toggleIcon.classList.add("bi-arrow-left-circle-fill");
                    contentContainer.classList.remove("container-fluid");
                    contentContainer.classList.add("container");
                }
            }

            function loadCollapseMenuState() {
                const carState = localStorage.getItem(CAR_MENU_STATE);
                const meetingState = localStorage.getItem(MEETING_MENU_STATE);
                const setMenuState = (menuId, savedState) => {
                    const menu = $(`#${menuId}`);
                    const toggle = $(`a[href="#${menuId}"]`);
                    if (savedState === 'false') {
                        menu.removeClass('show');
                        toggle.addClass('collapsed');
                        toggle.attr('aria-expanded', 'false');
                    } else if (savedState === 'true') {
                        menu.addClass('show');
                        toggle.removeClass('collapsed');
                        toggle.attr('aria-expanded', 'true');
                    } else {
                        menu.addClass('show');
                        toggle.removeClass('collapsed');
                        toggle.attr('aria-expanded', 'true');
                    }
                };
                setMenuState('carMenu', carState);
                setMenuState('meetingMenu', meetingState);
            }

            function saveRoomFilterState() {
                const roomStates = {};
                $(".room-filter").each(function() {
                    roomStates[$(this).val()] = $(this).is(":checked");
                });
                localStorage.setItem("roomFilterStates", JSON.stringify(roomStates));
            }

            function loadRoomFilterState() {
                const savedRoomStates = localStorage.getItem("roomFilterStates");
                let selectedRooms = [];
                let shouldSaveDefaultState = false;
                if (savedRoomStates) {
                    try {
                        const roomStates = JSON.parse(savedRoomStates);
                        $(".room-filter").each(function() {
                            const roomName = $(this).val();
                            const isChecked = roomStates.hasOwnProperty(roomName) ? roomStates[
                                roomName] : true;
                            $(this).prop("checked", isChecked);
                            if (isChecked) {
                                selectedRooms.push(roomName);
                            }
                        });
                    } catch (e) {
                        console.error("Error parsing room filter states from Local Storage:", e);
                        localStorage.removeItem("roomFilterStates");
                        shouldSaveDefaultState = true;
                    }
                }
                if (!savedRoomStates || shouldSaveDefaultState) {
                    $(".room-filter").prop("checked", true);
                    selectedRooms = $(".room-filter").map(function() {
                        return this.value;
                    }).get();
                    saveRoomFilterState();
                }
                return selectedRooms;
            }

            function initTheme() {
                applyTheme(darkMode);
            }

            function applyTheme(isDark) {
                const body = document.body;
                const profileThemeIcon = document.getElementById("profileThemeIcon");
                const profileThemeText = document.querySelector("#nav-profile-theme span");
                if (isDark) {
                    body.classList.add("dark-mode");
                    body.classList.remove("light-mode");
                    $('.light-mode-logo').css('display', 'none');
                    $('.dark-mode-logo').css('display', 'inline-block');
                    if (profileThemeIcon) profileThemeIcon.className = "bi bi-sun me-2";
                    if (profileThemeText) profileThemeText.textContent = "Switch to Light Mode";
                } else {
                    body.classList.add("light-mode");
                    body.classList.remove("dark-mode");
                    $('.dark-mode-logo').css('display', 'none');
                    $('.light-mode-logo').css('display', 'inline-block');
                    if (profileThemeIcon) profileThemeIcon.className = "bi bi-moon me-2";
                    if (profileThemeText) profileThemeText.textContent = "Switch to Dark Mode";
                }
            }

            function applyTableVisibility(isVisible) {
                const tableWrapper = $("#tableWrapper");
                const icon = $('#toggleTable i');
                if (isVisible) {
                    tableWrapper.show();
                    icon.removeClass("bi-eye-slash").addClass("bi-table");
                } else {
                    tableWrapper.hide();
                    icon.removeClass("bi-table").addClass("bi-eye-slash");
                }
            }

            function initPickers() {
                // ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ä‡πà‡∏≠‡∏á '‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°' ‡πÅ‡∏•‡∏∞ '‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î' ‡πÅ‡∏ó‡∏ô
                const flatpickrConfig = {
                    enableTime: true,
                    // ‚úÖ ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö YYYY-MM-DD HH:MM:SS
                    dateFormat: "Y-m-d H:i",
                    // ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô
                    noCalendar: false,
                    time_24hr: true,
                    onOpen: (selectedDates, dateStr, instance) => {
                        if (document.body.classList.contains('dark-mode')) {
                            instance.calendarContainer.classList.add('dark-mode');
                        } else {
                            instance.calendarContainer.classList.remove('dark-mode');
                        }
                    }
                };
                // ‡πÉ‡∏ä‡πâ config ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Start Time
                flatpickr("#start_time", flatpickrConfig);
                // ‡πÉ‡∏ä‡πâ config ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö End Time
                flatpickr("#end_time", flatpickrConfig);
            }
            // const formatTime = (datetime) => datetime ? datetime.substring(11) : "-";
            // function initPickers() {
            //     flatpickr("#meeting_date", {
            //         dateFormat: "Y-m-d",
            //         onOpen: (selectedDates, dateStr, instance) => {
            //             if (document.body.classList.contains('dark-mode')) {
            //                 instance.calendarContainer.classList.add('dark-mode');
            //             } else {
            //                 instance.calendarContainer.classList.remove('dark-mode');
            //             }
            //         }
            //     });
            //     flatpickr("#start_time", {
            //         enableTime: true,
            //         noCalendar: true,
            //         dateFormat: "H:i:s",
            //         onOpen: (selectedDates, dateStr, instance) => {
            //             if (document.body.classList.contains('dark-mode')) {
            //                 instance.calendarContainer.classList.add('dark-mode');
            //             } else {
            //                 instance.calendarContainer.classList.remove('dark-mode');
            //             }
            //         }
            //     });
            //     flatpickr("#end_time", {
            //         enableTime: true,
            //         noCalendar: true,
            //         dateFormat: "H:i:s",
            //         onOpen: (selectedDates, dateStr, instance) => {
            //             if (document.body.classList.contains('dark-mode')) {
            //                 instance.calendarContainer.classList.add('dark-mode');
            //             } else {
            //                 instance.calendarContainer.classList.remove('dark-mode');
            //             }
            //         }
            //     });
            // }
            function mapEventData(e) {
                const isAllDay = !e.start.includes('T') && !e.end.includes('T');
                return {
                    id: e.id,
                    title: e.title + " (" + e.room + ")",
                    start: e.start,
                    end: e.end,
                    extendedProps: e,
                    color: roomColors[e.room],
                    allDay: isAllDay,
                    display: 'auto',
                    startEditable: false,
                    durationEditable: false
                };
            }

          function showEventDetails(info) {
    const data = info.event.extendedProps;
    const isDarkMode = document.body.classList.contains('dark-mode');
    
    // ‡∏à‡∏±‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤: ‡∏ß‡∏±‡∏ô/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô/‡∏õ‡∏µ ‡∏ä‡∏°:‡∏ô‡∏≤‡∏ó‡∏µ
    const formatDateTime = (dateTimeStr) => {
        if (!dateTimeStr) return "-";
        const dateObj = new Date(dateTimeStr);
        const d = dateObj.toLocaleDateString('th-TH', {
            day: '2-digit',
            month: '2-digit',
            year: 'numeric'
        });
        const t = dateTimeStr.substring(11, 16); // ‡∏î‡∏∂‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞ ‡∏ä‡∏°:‡∏ô‡∏≤‡∏ó‡∏µ (HH:mm)
        return `${d} ${t}`;
    };

    const startDisplay = formatDateTime(data.start);
    const endDisplay = formatDateTime(data.end);

    const highlightColor = roomColors[data.room] || "#6c757d";
    const modalBody = document.querySelector("#detailModal .modal-body");
    
    modalBody.innerHTML = `
        <div class="container-fluid">
            <div class="row g-3">
                <div class="col-12 border-bottom pb-3 mb-2">
                    <h5 style="color: ${highlightColor};" class="mb-1 fw-bold">
                        <i class="bi bi-bookmark-fill me-2"></i>${data.title.replace(` (${data.room})`, '') || "Untitled Meeting"}
                    </h5>
                    <p class="mb-0 small ${isDarkMode ? 'text-light' : 'text-muted'}">
                        <strong class="${isDarkMode ? 'text-white' : ''}">Subject:</strong> ${data.subject || "No subject provided"}
                    </p>
                </div>

                <div class="col-md-6">
                    <label class="small d-block text-uppercase fw-bold ${isDarkMode ? 'text-white-50' : 'text-muted'}">Meeting Room</label>
                    <span class="fs-6 fw-bold ${isDarkMode ? 'text-white' : ''}"><i class="bi bi-door-open me-2" style="color: ${highlightColor};"></i>${data.room || "-"}</span>
                </div>
                <div class="col-md-6">
                    <label class="small d-block text-uppercase fw-bold ${isDarkMode ? 'text-white-50' : 'text-muted'}">Operating Unit</label>
                    <span class="fs-6 fw-bold ${isDarkMode ? 'text-white' : ''}"><i class="bi bi-building me-2" style="color: ${highlightColor};"></i>${data.operating_unit || "-"}</span>
                </div>

                <div class="col-md-6">
                    <label class="small d-block text-uppercase fw-bold ${isDarkMode ? 'text-white-50' : 'text-muted'}">Start</label>
                    <span class="fs-6 fw-bold ${isDarkMode ? 'text-white' : ''}"><i class="bi bi-calendar-event me-2" style="color: ${highlightColor};"></i>${startDisplay}</span>
                </div>
                <div class="col-md-6">
                    <label class="small d-block text-uppercase fw-bold ${isDarkMode ? 'text-white-50' : 'text-muted'}">End</label>
                    <span class="fs-6 fw-bold ${isDarkMode ? 'text-white' : ''}"><i class="bi bi-calendar-check me-2" style="color: ${highlightColor};"></i>${endDisplay}</span>
                </div>

                <div class="col-md-6">
                    <label class="small d-block text-uppercase fw-bold ${isDarkMode ? 'text-white-50' : 'text-muted'}">Booked By</label>
                    <span class="fs-6 fw-bold ${isDarkMode ? 'text-white' : ''}"><i class="bi bi-person-badge me-2" style="color: ${highlightColor};"></i>${data.booked_by || "-"}</span>
                </div>
                <div class="col-md-6">
                    <label class="small d-block text-uppercase fw-bold ${isDarkMode ? 'text-white-50' : 'text-muted'}">Booked Timestamp</label>
                    <span class="small ${isDarkMode ? 'text-light' : 'text-secondary'}"><i class="bi bi-cpu me-2"></i>${data.booked_time || "-"}</span>
                </div>

                <div class="col-12 mt-3">
                    <div class="p-3 rounded border shadow-sm" style="background-color: ${isDarkMode ? '#2a2a2a' : 'rgba(0,0,0,0.03)'}; border-left: 5px solid ${highlightColor} !important;">
                        <label class="small d-block text-uppercase fw-bold mb-1 ${isDarkMode ? 'text-white-50' : 'text-muted'}">Note / Description</label>
                        <div class="small ${isDarkMode ? 'text-white' : 'text-dark'}" style="white-space: pre-wrap;">${data.note || "No additional notes."}</div>
                    </div>
                </div>
            </div>
        </div>
    `;
    
    new bootstrap.Modal(document.getElementById("detailModal")).show();
}

            function initCalendars() {
                const initialRooms = loadRoomFilterState();
                const eventSourceConfig = {
                    url: DATA_URL,
                    method: 'GET',
                    failure: function() {
                        console.error("Failed to fetch events from data.json");
                    },
                    success: function(rawEvents) {
                        const events = rawEvents.map(mapEventData);
                        const selectedRooms = initialRooms.length > 0 ? initialRooms : $(
                            ".room-filter:checked").map(function() {
                            return this.value;
                        }).get();
                        return events.map(evt => {
                            const isVisible = selectedRooms.includes(evt.extendedProps.room);
                            evt.display = isVisible ? "auto" : "none";
                            return evt;
                        });
                    }
                };
                const isMobile = window.matchMedia("(max-width: 768px)").matches;
                const mainHeaderToolbar = isMobile ? {
                    left: "prev,next",
                    right: "dayGridMonth,timeGridWeek,timeGridDay,listMonth,multiMonthYear"
                } : {
                    left: "prev,next today",
                    center: "title",
                    right: "dayGridMonth,timeGridWeek,timeGridDay,listMonth,multiMonthYear"
                };
                calendar = new FullCalendar.Calendar(document.getElementById("calendar"), {
                    themeSystem: 'bootstrap5',
                    initialView: "dayGridMonth",
                    height: "auto",
                    headerToolbar: mainHeaderToolbar,
                    buttonText: {
                        today: "Today",
                        month: "Month",
                        week: "Week",
                        day: "Day",
                        listMonth: 'List',
                        multiMonthYear: 'Annual'
                    },
                    timeZone: 'local',
                    views: {
                        dayGridMonth: {
                            titleFormat: {
                                month: 'long'
                            }
                        },
                    },
                    events: eventSourceConfig,
                    eventClick: showEventDetails
                });
                const miniHeaderToolbar = isMobile ? {
                    left: "prev",
                    center: "title",
                    right: "next"
                } : {
                    left: "prev",
                    center: "title",
                    right: "next"
                };
                miniCal = new FullCalendar.Calendar(document.getElementById("miniCalendar"), {
                    initialView: "dayGridMonth",
                    height: "auto",
                    contentHeight: "auto",
                    expandRows: true,
                    headerToolbar: miniHeaderToolbar,
                    events: eventSourceConfig,
                    eventClick: showEventDetails,
                    selectable: true,
                    dateClick: info => calendar.gotoDate(info.dateStr)
                });
                calendar.render();
                miniCal.render();
            }

            function initTable() {
                const initialRooms = loadRoomFilterState();
                applyRoomFilter(false);
                table = $("#bookingTable").DataTable({
                    dom: '<"row"<"col-sm-12 col-md-6"l><"col-sm-12 col-md-6 d-flex align-items-center justify-content-end"fB>>' +
                        '<"row spacer-row">' +
                        '<"row"<"col-sm-12"t>>' +
                        '<"row spacer-row">' +
                        '<"row"<"col-sm-12 col-md-5"i><"col-sm-12 col-md-7"p>>',
                    initComplete: function() {
                        $(this.api().table().container()).find('.dt-buttons').css({
                            'margin-left': '15px',
                            'margin-bottom': '0'
                        });
                        $(this.api().table().container()).find('.dataTables_filter').css({
                            'margin-right': '0',
                            'margin-bottom': '0'
                        });
                        // üö© Apply theme immediately after init
                        updateDatatableButtonTheme(darkMode);
                    },
                    buttons: [{
                            extend: 'copyHtml5',
                            text: '<i class="bi bi-files"></i>',
                            className: 'btn btn-light btn-sm',
                            exportOptions: {
                                columns: ':visible'
                            }
                        },
                        {
                            extend: 'excelHtml5',
                            text: '<i class="bi bi-file-earmark-excel"></i>',
                            className: 'btn btn-light btn-sm',
                            exportOptions: {
                                columns: ':visible'
                            }
                        },
                        {
                            extend: 'csvHtml5',
                            text: '<i class="bi bi-filetype-csv"></i>',
                            className: 'btn btn-light btn-sm',
                            exportOptions: {
                                columns: ':visible'
                            }
                        },
                        {
                            extend: 'print',
                            text: '<i class="bi bi-printer"></i>',
                            className: 'btn btn-light btn-sm',
                            exportOptions: {
                                columns: ':visible'
                            }
                        }
                    ],
                    ajax: {
                        url: DATA_URL,
                        dataSrc: ""
                    },
                    columns: [{
                            data: "room"
                        },
                        {
                            data: "title"
                        },
                        {
                            data: "start",
                            render: function(data, type, row) {
                                return data.substring(0, 10);
                            }
                        },
                        {
                            data: "end",
                            render: function(data, type, row) {
                                const startTime = row.start.substring(11, 16);
                                const endTime = data.substring(11, 16);
                                return `${startTime} - ${endTime}`;
                            }
                        },
                        {
                            data: "booked_by"
                        },
                        {
                            data: "operating_unit"
                        }
                    ],
                    stateSave: true
                });
                
                table.on('init', function() {
                    let searchVal;
                    if (initialRooms.length === 0) {
                        searchVal = "^$";
                    } else {
                        const escapedRooms = initialRooms.map(room => {
                            return room.replace(/[-\/\\^$*+?.()|[\]{}]/g, '\\$&');
                        });
                        searchVal = "^(" + escapedRooms.join("|") + ")$";
                    }
                    table.column(0).search(searchVal, true, false).draw();
                });
                // üö© Apply theme on every draw (e.g., page change, sort)
                // table.on('draw.dt', function() {
                //     applyPaginationTheme(darkMode);
                // });
                table.on('init', function() {
                    syncCheckboxesFromTable();
                    applyPaginationTheme(darkMode);
                     // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏£‡∏ß‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ Calendar ‡πÅ‡∏•‡∏∞ Table ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô
                });

                applyTableVisibility(isTableVisible);

                
            }

            function updateDatatableButtonTheme(isDark) {
                if (!table) return;
                const exportButtons = table.buttons().containers().find('.btn');
                if (isDark) {
                    exportButtons.removeClass('btn-light').addClass('btn-dark');
                } else {
                    exportButtons.removeClass('btn-dark').addClass('btn-light');
                }
                applyPaginationTheme(isDark);
            }

            function loadUnitFilterState() {
                const savedUnit = localStorage.getItem(UNIT_FILTER_KEY);
                if (savedUnit) {
                    $("#unitFilter").val(savedUnit);
                }
            }

            function saveFilterState() {
    const selectedRooms = $(".room-filter:checked").map(function() { 
        return this.value; 
    }).get();
    
    const selectedUnit = $("#unitFilter").val();

    // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
    localStorage.setItem('selectedRooms', JSON.stringify(selectedRooms));
    localStorage.setItem('selectedUnit', selectedUnit);
}

            function applyPaginationTheme(isDark) {
                if (!table) return;
                const paginateButtons = $(table.table().container()).find(
                    '.dataTables_paginate .paginate_button');
                paginateButtons.removeClass('btn-light btn-dark btn-sm');
                paginateButtons.addClass('btn btn-sm');
                if (isDark) {
                    paginateButtons.addClass('btn-dark');
                    // DataTables Bootstrap CSS handles the .current and .disabled state
                } else {
                    paginateButtons.addClass('btn-light');
                    // DataTables Bootstrap CSS handles the .current and .disabled state
                    // We ensure current button gets the primary look in light mode
                    paginateButtons.filter('.current').css({
                        'background-color': '#0d6efd',
                        'border-color': '#0d6efd',
                        'color': '#fff'
                    });
                }
                // Apply standard non-active styling (mainly for light mode border consistency)
                paginateButtons.not('.current').css({
                    'background-color': isDark ? '#2a2a2a' : 'transparent',
                    'border-color': isDark ? '#555' : '#dee2e6',
                    'color': isDark ? '#ddd' : '#0d6efd'
                });
                // Handle Disabled buttons (in-line override for better contrast in both themes)
                paginateButtons.filter('.disabled').css({
                    'background-color': isDark ? '#1f1f1f' : '#f8f9fa',
                    'border-color': isDark ? '#333' : '#dee2e6',
                    'color': isDark ? '#555' : '#ccc'
                });
            }

            function initEventHandlers() {
                $("#sidebarToggle").on("click", function() {
                    isSidebarCollapsed = !isSidebarCollapsed;
                    localStorage.setItem("isSidebarCollapsed", isSidebarCollapsed);
                    applySidebarState(isSidebarCollapsed);
                    setTimeout(() => {
                        calendar.updateSize();
                        miniCal.updateSize();
                    }, 300);
                });
                $("#nav-profile-theme").on("click", function(e) {
                    e.preventDefault();
                    darkMode = !darkMode;
                    localStorage.setItem("darkMode", darkMode);
                    applyTheme(darkMode);
                    // Update DataTable theme and redraw pagination immediately
                    updateDatatableButtonTheme(darkMode);
                    if (table) {
                        applyPaginationTheme(darkMode);
                    }
                });
                $('#carMenu').on('hidden.bs.collapse', function() {
                    localStorage.setItem(CAR_MENU_STATE, 'false');
                });
                $('#carMenu').on('shown.bs.collapse', function() {
                    localStorage.setItem(CAR_MENU_STATE, 'true');
                });
                $('#meetingMenu').on('hidden.bs.collapse', function() {
                    localStorage.setItem(MEETING_MENU_STATE, 'false');
                });
                $('#meetingMenu').on('shown.bs.collapse', function() {
                    localStorage.setItem(MEETING_MENU_STATE, 'true');
                });
                $("#sidebarMenu .nav-link").on("click", function(e) {
                    e.preventDefault();
                    $("#sidebarMenu .nav-link").removeClass("active").removeAttr("aria-current");
                    $(this).addClass("active").attr("aria-current", "page");
                    localStorage.setItem(ACTIVE_MENU_KEY, this.id);
                });
                $('.navbar-nav .dropdown-item').on('click', function(e) {
                    e.preventDefault();
                    const clickedId = $(this).attr('id');
                    $('.navbar-nav .nav-link, .navbar-nav .dropdown-item').removeClass('active');
                    $(this).addClass('active');
                    const parentDropdownToggle = $(this).closest('.dropdown').find('.dropdown-toggle')
                        .first();
                    parentDropdownToggle.addClass('active');
                    const dropendToggle = $(this).closest('.dropend').find(
                        '.dropdown-item.dropdown-toggle');
                    dropendToggle.addClass('active');
                    localStorage.setItem(NAVBAR_ACTIVE_KEY, clickedId);
                });
                // Dropdown Sub-menu on Hover (for desktop)
                $('.dropend').on('mouseenter', function() {
                    var $el = $(this);
                    var $menu = $el.find('.dropdown-menu');
                    $menu.addClass('show');
                    if ($menu.offset().left + $menu.width() > $(window).width()) {
                        $menu.removeClass('dropdown-menu-end').addClass('dropdown-menu-start');
                    }
                }).on('mouseleave', function() {
                    var $el = $(this);
                    var $menu = $el.find('.dropdown-menu');
                    $menu.removeClass('show');
                    $menu.removeClass('dropdown-menu-start').addClass('dropdown-menu-end');
                });
            // ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô Dropdown ‡πÉ‡∏´‡πâ‡∏Å‡∏£‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏Ñ‡∏π‡πà
// ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏à‡∏≤‡∏Å‡πÄ‡∏î‡∏¥‡∏°
$("#unitFilter").on("change", function() {
    localStorage.setItem(UNIT_FILTER_KEY, $(this).val()); // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ
    applyAllFilters();
});

// ‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á Checkbox ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á ‡∏Å‡πá‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô
$(".room-filter").on("change", function() {
    applyAllFilters();
});
                $("#bookingForm").on("submit", handleBookingSubmit);
                $("#toggleTable").on("click", function() {
                    const tableWrapper = $("#tableWrapper");
                    const newState = !tableWrapper.is(":visible");
                    applyTableVisibility(newState);
                    localStorage.setItem("isTableVisible", newState);
                    if (newState) {
                        table.draw(false);
                    }
                });
            }
            

            

            function filterDataTableByRooms() {
                let selectedRooms = $(".room-filter:checked").map(function() {
                    return this.value;
                }).get();
                let searchVal;
                if (selectedRooms.length === 0) {
                    searchVal = "^$";
                } else {
                    const escapedRooms = selectedRooms.map(room => {
                        return room.replace(/[-\/\\^$*+?.()|[\]{}]/g, '\\$&');
                    });
                    searchVal = "^(" + escapedRooms.join("|") + ")$";
                }
                table.column(0).search('');
                table.column(0).search(searchVal, true, false).draw();
            }

            function applyDataTableFilters() {
    if (!table) return;

    // 1. ‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏´‡πâ‡∏≠‡∏á (‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏ó‡∏µ‡πà 0) - ‡∏≠‡∏¥‡∏á‡∏à‡∏≤‡∏Å Checkbox ‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
    let selectedRooms = $(".room-filter:checked").map(function() {
        return this.value;
    }).get();
    
    let roomSearchVal;
    if (selectedRooms.length === 0) {
        roomSearchVal = "^$"; // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏•‡∏¢ ‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
    } else {
        const escapedRooms = selectedRooms.map(room => room.replace(/[-\/\\^$*+?.()|[\]{}]/g, '\\$&'));
        roomSearchVal = "^(" + escapedRooms.join("|") + ")$";
    }
    table.column(0).search(roomSearchVal, true, false);

    // 2. ‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏° Operating Unit (‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏ó‡∏µ‡πà 5) - ‡∏≠‡∏¥‡∏á‡∏à‡∏≤‡∏Å Dropdown ‡πÉ‡∏ô Card
    let selectedUnit = $("#unitFilter").val();
    if (selectedUnit) {
        // ‡πÉ‡∏ä‡πâ Regex ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏õ‡πä‡∏∞‡πÜ (Exact Match)
        table.column(5).search('^' + selectedUnit.replace(/[-\/\\^$*+?.()|[\]{}]/g, '\\$&') + '$', true, false);
    } else {
        table.column(5).search(''); // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡∏ß‡πà‡∏≤‡∏á ‡πÉ‡∏´‡πâ‡∏•‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏≠‡∏á‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô
    }

    table.draw();
}

function applyAllFilters() {
    const selectedUnit = $("#unitFilter").val();
    const selectedRooms = $(".room-filter:checked").map(function() { return this.value; }).get();

    // --- 1. ‡∏Å‡∏£‡∏≠‡∏á‡∏ö‡∏ô Main Calendar ---
    calendar.getEvents().forEach(event => {
        const eventUnit = event.extendedProps.operating_unit;
        const eventRoom = event.extendedProps.room;
        
        const matchesUnit = !selectedUnit || eventUnit === selectedUnit;
        const matchesRoom = selectedRooms.includes(eventRoom);

        if (matchesUnit && matchesRoom) {
            event.setProp('display', 'auto');
        } else {
            event.setProp('display', 'none');
        }
    });

    // --- 2. ‡∏Å‡∏£‡∏≠‡∏á‡∏ö‡∏ô Data Table ---
    applyDataTableFilters();

    // --- 3. ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï Mini Calendar (‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÉ‡∏´‡∏°‡πà) ---
    if (typeof miniCal !== 'undefined') {
        miniCal.getEvents().forEach(event => {
            const eventUnit = event.extendedProps.operating_unit;
            const eventRoom = event.extendedProps.room;
            const matchesUnit = !selectedUnit || eventUnit === selectedUnit;
            const matchesRoom = selectedRooms.includes(eventRoom);
            event.setProp('display', (matchesUnit && matchesRoom) ? 'auto' : 'none');
        });
    }
}

function syncCheckboxesFromTable() {
    // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡πâ‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏ñ‡∏π‡∏Å Filter ‡πÅ‡∏•‡πâ‡∏ß
    const visibleRooms = table.column(0, { filter: 'applied' }).data().toArray();
    const uniqueVisibleRooms = [...new Set(visibleRooms)];

    // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï Checkbox: ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏´‡πâ‡∏≠‡∏á‡∏ô‡∏±‡πâ‡∏ô‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÉ‡∏´‡πâ Uncheck (‡∏´‡∏£‡∏∑‡∏≠‡∏à‡∏≤‡∏á‡∏•‡∏á)
    $(".room-filter").each(function() {
        const roomName = $(this).val();
        if (uniqueVisibleRooms.includes(roomName)) {
            // Optional: ‡πÄ‡∏û‡∏¥‡πà‡∏° Effect ‡πÉ‡∏´‡πâ‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤‡∏´‡πâ‡∏≠‡∏á‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            $(this).closest('.form-check').css('opacity', '1');
        } else {
            // Optional: ‡∏à‡∏≤‡∏á Checkbox ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á
            $(this).closest('.form-check').css('opacity', '0.5');
        }
    });
}


            function applyRoomFilter(updateTable = true) {
                let selectedRooms = $(".room-filter:checked").map(function() {
                    return this.value;
                }).get();
                const filterFunc = evt => selectedRooms.includes(evt.extendedProps.room) ? "auto" : "none";
                calendar.getEvents().forEach(evt => evt.setProp("display", filterFunc(evt)));
                miniCal.getEvents().forEach(evt => evt.setProp("display", filterFunc(evt)));
                if (updateTable) {
                    filterDataTableByRooms();
                }
            }

            function handleBookingSubmit(e) {
                e.preventDefault();
                const formData = new FormData(e.target);
                const bookingData = Object.fromEntries(formData.entries());
                console.log("New Booking Data Submitted (Simulated):", bookingData);
                alert(`‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á "${bookingData.room}" ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! (Title: ${bookingData.title})`);
                bootstrap.Modal.getInstance(document.getElementById("bookingModal")).hide();
                $("#bookingForm")[0].reset();
                table.ajax.reload(function() {
                    calendar.refetchEvents();
                    miniCal.refetchEvents();
                    calendar.gotoDate(bookingData.meeting_date);
                    filterDataTableByRooms();
                }, false);
            }
            // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏õ‡∏µ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡πÉ‡∏ô Footer
            document.getElementById("currentYear").textContent = new Date().getFullYear();
            document.getElementById("currentTime").textContent = new Date().toLocaleTimeString('th-TH', {
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
        });
    </script>
</body>

</html>